<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Sphere - Portfolio</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        .sphere-page-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            text-align: center;
            padding: 2rem;
        }

        .sphere-canvas {
            width: 100%;
            height: 70vh;
            max-width: 800px;
            margin: 2rem 0;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .sphere-info {
            max-width: 600px;
            margin: 2rem auto;
        }

        .sphere-info h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .sphere-info p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .back-button {
            display: inline-block;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            margin-top: 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #4ecdc4;
            font-size: 1.2rem;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .sphere-info h1 {
                font-size: 2rem;
            }

            .sphere-info p {
                font-size: 1rem;
            }

            .sphere-canvas {
                height: 50vh;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <div class="sphere-logo" id="sphere-logo"></div>
        </div>
        <nav class="navbar">
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#about">About</a></li>
                <li><a href="index.html#gallery">Gallery</a></li>
                <li><a href="sphere.html" class="active">3D Sphere</a></li>
                <li><a href="index.html#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main class="sphere-page-container">
        <div class="sphere-info">
            <h1>Interactive 3D Sphere</h1>
            <p>Experience this stunning 3D sphere loaded from sphere.glb file. The sphere features dynamic lighting, realistic materials, and smooth animations that respond to your interactions.</p>
            <p>Use your mouse to orbit around the sphere and see how the lighting creates beautiful reflections and shadows on its surface.</p>
        </div>

        <div class="sphere-canvas-container" style="position: relative;">
            <canvas class="sphere-canvas" id="sphereCanvas"></canvas>
            <div class="loading" id="loading">Loading sphere.glb model...</div>
        </div>

        <a href="index.html" class="back-button">‚Üê Back to Portfolio</a>
    </main>

    <script>
        // Simple GLTF loader for scene folder
        let scene, camera, renderer, controls, loader;

        document.addEventListener('DOMContentLoaded', function() {
            initScene();
            initNavbar();
        });

        function initScene() {
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a1a2e);

            // Create camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);

            // Create renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, canvas: document.getElementById('sphereCanvas') });
            renderer.setSize(document.getElementById('sphereCanvas').clientWidth, document.getElementById('sphereCanvas').clientHeight);
            renderer.outputEncoding = THREE.sRGBEncoding;

            // Initialize GLTF Loader
            loader = new THREE.GLTFLoader();

            // Load scene from scene folder
            loadScene();

            // Add basic lighting
            const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);

            // Add OrbitControls for mouse interaction
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.enableZoom = true;

            // Handle window resize
            window.addEventListener('resize', onWindowResize);

            // Create immediate fallback sphere for testing
            console.log('Creating immediate fallback sphere for testing...');
            const geometry = new THREE.SphereGeometry(1.5, 32, 32);
            const material = new THREE.MeshStandardMaterial({
                color: 0xff6b6b,
                roughness: 0.3,
                metalness: 0.1
            });
            const testSphere = new THREE.Mesh(geometry, material);
            scene.add(testSphere);

            console.log('Test sphere added to scene');

            // Hide loading indicator after 2 seconds
            setTimeout(() => {
                const loading = document.getElementById('loading');
                if (loading) {
                    loading.innerHTML = 'Test sphere loaded - GLTF loading in progress...';
                    setTimeout(() => {
                        loading.style.display = 'none';
                    }, 1000);
                }
            }, 2000);
        }

        function loadScene() {
            console.log('Starting GLTF load from: assets/scene/scene.gltf');
            console.log('Current working directory should be:', window.location.href);

            // Try multiple path variations to ensure we can access the file
            const possiblePaths = [
                'assets/scene/scene.gltf',
                './assets/scene/scene.gltf',
                '/assets/scene/scene.gltf',
                'scene/scene.gltf',
                './scene/scene.gltf'
            ];

            let pathIndex = 0;

            function tryLoadWithPath(path) {
                console.log(`Attempting to load from path: ${path}`);

                loader.load(
                    path,
                    function (gltf) {
                        console.log('GLTF loaded successfully from:', path);
                        console.log('GLTF scene structure:', gltf.scene);
                        console.log('Number of objects in scene:', gltf.scene.children.length);

                        const loadedScene = gltf.scene;
                        scene.add(loadedScene);

                        console.log('Scene added to Three.js scene successfully!');

                        // Update loading text
                        const loading = document.getElementById('loading');
                        if (loading) {
                            loading.innerHTML = 'Scene loaded successfully!';
                            setTimeout(() => {
                                loading.style.display = 'none';
                            }, 1000);
                        }
                    },
                    function (progress) {
                        // Loading progress
                        const percentComplete = (progress.loaded / progress.total) * 100;
                        console.log(`Loading progress (${path}): ${Math.round(percentComplete)}%`);
                    },
                    function (error) {
                        console.error(`Error loading GLTF from ${path}:`, error);
                        console.error('Error type:', error.constructor.name);
                        console.error('Error message:', error.message);

                        // Try next path
                        pathIndex++;
                        if (pathIndex < possiblePaths.length) {
                            console.log(`Trying alternative path: ${possiblePaths[pathIndex]}`);
                            tryLoadWithPath(possiblePaths[pathIndex]);
                        } else {
                            console.error('All path attempts failed. Trying fallback...');
                            const loading = document.getElementById('loading');
                            if (loading) {
                                loading.innerHTML = 'All loading attempts failed. Using fallback sphere.';
                            }
                            loadSceneWithoutTextures();
                        }
                    }
                );
            }

            // Start with the first path
            tryLoadWithPath(possiblePaths[0]);
        }

        function loadSceneWithoutTextures() {
            console.log('Creating immediate fallback sphere...');

            // Create a simple sphere as ultimate fallback
            const geometry = new THREE.SphereGeometry(2, 32, 32);
            const material = new THREE.MeshStandardMaterial({
                color: 0x4ecdc4,
                roughness: 0.3,
                metalness: 0.1
            });
            const fallbackSphere = new THREE.Mesh(geometry, material);

            scene.add(fallbackSphere);

            console.log('Fallback sphere created successfully!');

            const loading = document.getElementById('loading');
            if (loading) {
                loading.innerHTML = 'Loaded fallback sphere - GLTF loading failed';
                setTimeout(() => {
                    loading.style.display = 'none';
                }, 2000);
            }
        }

        // Test file accessibility with different methods
        function testFileAccess() {
            console.log('Testing file accessibility...');

            // Test 1: XMLHttpRequest
            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'assets/scene/scene.gltf', true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    console.log('XMLHttpRequest result:', xhr.status, xhr.statusText);
                    if (xhr.status === 200) {
                        console.log('File is accessible via XMLHttpRequest');
                    } else {
                        console.log('File not accessible via XMLHttpRequest');
                    }
                }
            };
            xhr.send();

            // Test 2: Direct fetch
            fetch('assets/scene/scene.gltf')
                .then(response => {
                    console.log('Fetch result:', response.status, response.statusText);
                    console.log('Response type:', response.type);
                    console.log('Response url:', response.url);
                    return response.text();
                })
                .then(text => {
                    console.log('File content length:', text.length, 'characters');
                    console.log('File starts with:', text.substring(0, 50));
                })
                .catch(error => {
                    console.error('Fetch failed:', error);
                });
        }

        // Run file access test
        testFileAccess();

        function animate() {
            requestAnimationFrame(animate);

            if (controls) {
                controls.update();
            }

            renderer.render(scene, camera);
        }

        function onWindowResize() {
            const canvas = document.getElementById('sphereCanvas');
            camera.aspect = canvas.clientWidth / canvas.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
        }

        function initNavbar() {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');

            if (navToggle && navMenu) {
                navToggle.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                    navToggle.classList.toggle('active');

                    const spans = navToggle.querySelectorAll('span');
                    if (navToggle.classList.contains('active')) {
                        spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                        spans[1].style.opacity = '0';
                        spans[2].style.transform = 'rotate(-45deg) translate(7px, -6px)';
                    } else {
                        spans[0].style.transform = 'none';
                        spans[1].style.opacity = '1';
                        spans[2].style.transform = 'none';
                    }
                });

                const navLinks = document.querySelectorAll('.nav-menu a');
                navLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        navMenu.classList.remove('active');
                        navToggle.classList.remove('active');

                        const spans = navToggle.querySelectorAll('span');
                        spans[0].style.transform = 'none';
                        spans[1].style.opacity = '1';
                        spans[2].style.transform = 'none';
                    });
                });
            }
        }

        // Start animation loop
        animate();
    </script>
</body>
</html>